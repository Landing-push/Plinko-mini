<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bet Office Plinko</title>
    <style>
        :root {
            --bg1: #00279c;
            --bg2: #001a6b;
            --card: rgba(255, 255, 255, 0.08);
            --border: rgba(255, 255, 255, 0.15);
            --gold1: #ffc247;
            --gold2: #fea703;
            --text: #ffffff;
            --muted: rgba(255, 255, 255, 0.8);
            --shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
            --glow: 0 0 20px rgba(254, 167, 3, 0.25);
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', Roboto, Arial, sans-serif;
            color: var(--text);
            background:
                linear-gradient(135deg, rgba(0, 26, 107, 0.95), rgba(0, 12, 51, 0.98)),
                repeating-linear-gradient(45deg,
                    transparent,
                    transparent 35px,
                    rgba(254, 167, 3, 0.03) 35px,
                    rgba(254, 167, 3, 0.03) 70px),
                radial-gradient(circle at 20% 30%, rgba(255, 194, 71, 0.15), transparent 40%),
                radial-gradient(circle at 80% 70%, rgba(0, 100, 255, 0.15), transparent 40%),
                linear-gradient(180deg, #001452, #000a2e);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background:
                radial-gradient(circle at center, transparent 0%, rgba(0, 0, 0, 0.4) 100%),
                repeating-linear-gradient(0deg,
                    rgba(255, 255, 255, 0.03) 0px,
                    transparent 2px,
                    transparent 4px,
                    rgba(255, 255, 255, 0.03) 6px);
            animation: grain 8s steps(10) infinite;
            pointer-events: none;
            z-index: 1;
        }

        @keyframes grain {

            0%,
            100% {
                transform: translate(0, 0);
            }

            10% {
                transform: translate(-5%, -10%);
            }

            20% {
                transform: translate(-15%, 5%);
            }

            30% {
                transform: translate(7%, -25%);
            }

            40% {
                transform: translate(-5%, 25%);
            }

            50% {
                transform: translate(-15%, 10%);
            }

            60% {
                transform: translate(15%, 0%);
            }

            70% {
                transform: translate(0%, 15%);
            }

            80% {
                transform: translate(3%, 35%);
            }

            90% {
                transform: translate(-10%, 10%);
            }
        }

        .wrap {
            width: min(860px, 100%);
            display: grid;
            gap: 14px;
            padding: 20px;
            position: relative;
            z-index: 10;
            flex: 1;
            align-content: center;
        }

        .navbar {
            width: 100%;
            height: 85px;
            background: linear-gradient(135deg, rgba(10, 20, 60, 0.98), rgba(20, 30, 80, 0.95));
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(254, 167, 3, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            padding: 15px 0;
        }

        .nav-logo {
            height: 45px;
            width: auto;
        }



        @media (min-width: 521px) {
            .navbar {
                height: 75px;
                padding: 12px 0;
            }

            .wrap {
                gap: 8px;
                padding: 10px 20px;
            }

            .panel {
                padding: 8px 14px;
            }
        }

        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .badge {
            width: 44px;
            height: 44px;
            border-radius: 14px;
            background: linear-gradient(180deg, rgba(255, 216, 74, 0.2), rgba(255, 216, 74, 0.05));
            border: 1px solid rgba(255, 216, 74, 0.25);
            box-shadow: var(--glow);
            display: grid;
            place-items: center;
            overflow: hidden;
        }

        .badge img {
            width: 80%;
            height: 80%;
            object-fit: contain;
        }

        h1 {
            margin: 0;
            font-size: 22px;
            letter-spacing: 0.4px;
        }

        .sub {
            font-size: 12px;
            color: var(--muted);
            margin-top: 2px;
        }

        .panel {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
            justify-content: space-between;
            background: rgba(15, 25, 50, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(254, 167, 3, 0.2);
            border-radius: 16px;
            padding: 12px 14px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .stat {
            min-width: 170px;
            font-size: 13px;
            color: var(--muted);
        }

        .stat b {
            color: var(--text);
            font-size: 16px;
        }

        .controls {
            display: flex;
            gap: 10px;
            align-items: center;
            justify-content: flex-end;
            flex: 1;
            min-width: 320px;
        }

        input[type="number"] {
            width: 120px;
            background: rgba(0, 0, 0, 0.35);
            border: 1px solid rgba(255, 255, 255, 0.18);
            color: var(--text);
            padding: 10px 12px;
            border-radius: 14px;
            outline: none;
            font-size: 14px;
        }

        .btn {
            border: none;
            cursor: pointer;
            padding: 11px 18px;
            border-radius: 14px;
            font-weight: 900;
            letter-spacing: 0.3px;
            transition: transform .12s ease, opacity .12s ease;
            box-shadow: var(--shadow);
            white-space: nowrap;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-gold {
            background: linear-gradient(180deg, var(--gold1), var(--gold2));
            color: #0b1220;
            box-shadow: var(--shadow), var(--glow);
        }

        .btn-outline {
            background: rgba(255, 255, 255, 0.06);
            color: var(--text);
            border: 1px solid rgba(255, 255, 255, 0.14);
        }

        .board {
            position: relative;
            border-radius: 18px;
            border: 1px solid rgba(254, 167, 3, 0.2);
            background:
                linear-gradient(180deg, rgba(20, 30, 70, 0.95), rgba(10, 20, 50, 0.98)),
                radial-gradient(circle at 30% 20%, rgba(254, 167, 3, 0.08), transparent 60%),
                radial-gradient(circle at 70% 80%, rgba(0, 100, 200, 0.08), transparent 60%);
            box-shadow:
                0 20px 60px rgba(0, 0, 0, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
            overflow: hidden;
        }

        canvas {
            display: block;
            width: 100%;
            height: auto;
        }

        .note {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.72);
            text-align: center;
        }

        /* --- Modal --- */
        .modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.85);
            display: none;
            align-items: center;
            justify-content: center;
            padding: 16px;
            z-index: 200;
        }

        .modal.show {
            display: flex;
        }

        .modal-card {
            width: min(720px, 100%);
            border-radius: 22px;
            background:
                radial-gradient(circle at top left, rgba(254, 167, 3, 0.20), transparent 55%),
                radial-gradient(circle at top, rgba(0, 39, 156, 0.25), transparent 60%),
                linear-gradient(180deg, #001a6b, #000c33);
            border: 1px solid rgba(255, 255, 255, 0.14);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.55);
            position: relative;
            padding: 26px 24px 22px;
            overflow: hidden;
        }

        .coin {
            position: absolute;
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background:
                radial-gradient(circle at 35% 30%, rgba(255, 255, 255, 0.75), transparent 35%),
                radial-gradient(circle at center, #ffcf75, #fea703 65%, #c77e00);
            box-shadow: 0 14px 26px rgba(0, 0, 0, 0.35), 0 0 24px rgba(254, 167, 3, 0.18);
            border: 2px solid rgba(255, 255, 255, 0.25);
        }

        /* "hanging off the edge" coins */
        .coin.tl {
            top: -45px;
            left: -45px;
            transform: rotate(-14deg);
        }

        .coin.tr {
            top: -50px;
            right: -50px;
            transform: rotate(16deg);
        }

        .coin.bl {
            bottom: -55px;
            left: -55px;
            transform: rotate(10deg);
        }

        .coin.br {
            bottom: -50px;
            right: -50px;
            transform: rotate(-12deg);
        }

        .coin::after {
            content: "₺";
            position: absolute;
            inset: 0;
            display: grid;
            place-items: center;
            font-weight: 900;
            font-size: 56px;
            color: rgba(11, 18, 32, 0.35);
            text-shadow: 0 2px 0 rgba(255, 255, 255, 0.15);
        }

        .modal-title {
            text-align: center;
            color: var(--gold1);
            font-weight: 900;
            font-size: 46px;
            letter-spacing: 1px;
            margin: 0 0 10px;
            text-transform: uppercase;
        }

        .modal-body {
            text-align: center;
            font-size: 18px;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 18px;
            line-height: 1.4;
        }

        .modal-win {
            display: inline-block;
            margin-top: 6px;
            font-weight: 900;
            color: #fff;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.12);
            padding: 8px 12px;
            border-radius: 12px;
        }

        .modal-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 16px;
        }

        @media (max-width:520px) {
            .nav-logo {
                height: 31.5px;
            }

            .modal-title {
                font-size: 36px;
            }

            .controls {
                min-width: 100%;
                justify-content: flex-start;
            }
        }
    </style>
</head>

<body>

    <nav class="navbar">
        <img src="betoffice-logo.svg" alt="Bet Office Logo" class="nav-logo">
    </nav>

    <div class="wrap">
        <div class="panel">
            <div class="stat">Bakiye: <b id="balance">₺50.00</b></div>
            <div class="stat">Son kazanç: <b id="lastwin">₺0.00</b></div>

            <div class="controls">
                <input id="bet" type="number" min="0.01" step="0.01" value="5.00" />
                <button class="btn btn-gold" id="dropBtn">BIRAK</button>
            </div>
        </div>

        <div class="board">
            <canvas id="game" width="820" height="580"></canvas>
        </div>


    </div>

    <!-- Modal -->
    <div class="modal" id="modal">
        <div class="modal-card" role="dialog" aria-modal="true">
            <div class="coin tl"></div>
            <div class="coin tr"></div>
            <div class="coin bl"></div>
            <div class="coin br"></div>

            <h2 class="modal-title">TEBRİKLER!</h2>

            <div class="modal-body">
                <strong>50₺ Hoşgeldin Bonusu</strong> kazandınız!
                <div class="modal-win" id="winText">₺50.00</div>
            </div>

            <div class="modal-actions">
                <button class="btn btn-gold" id="goPromo">BONUSU AL →</button>
            </div>
        </div>
    </div>

    <script>
        (() => {
            // =============================
            // CONFIG
            // =============================
            const PROMO_LINK = "https://bo.t2m.io/mt2";
            const OPEN_MODAL_ON_WIN = true;
            const OPEN_MODAL_MIN_WIN = 1;

            // =============================
            // Canvas + Physics
            // =============================
            const canvas = document.getElementById("game");
            const ctx = canvas.getContext("2d");

            const W = canvas.width;
            const H = canvas.height;

            const gravity = 0.34;
            const bounce = 0.86;
            const airFriction = 0.995;

            const pegRadius = 6;
            const ballRadius = 10;

            const topPadding = 60;
            const sidePadding = 70;

            const rows = 11;
            const rowGap = 34;
            const colGap = 56;

            const multipliers = [0.2, 0.5, 1, 1.2, 1.5, 2, 3, 5, 10];
            const slotCount = multipliers.length;

            const slotY = H - 85;
            const slotH = 66; // ~40% reduction
            const slotW = (W - sidePadding * 2) / slotCount;

            // =============================
            // UI State
            // =============================
            let balance = 50;
            let lastWin = 0;
            let dropping = false;
            let ball = null;

            const balanceEl = document.getElementById("balance");
            const lastWinEl = document.getElementById("lastwin");
            const betEl = document.getElementById("bet");
            const dropBtn = document.getElementById("dropBtn");

            // Modal
            const modal = document.getElementById("modal");
            const winText = document.getElementById("winText");
            const goPromo = document.getElementById("goPromo");

            function fmt(n) { return `₺${n.toFixed(2)}`; }
            function updateUI() {
                balanceEl.textContent = fmt(balance);
                lastWinEl.textContent = fmt(lastWin);
            }
            updateUI();

            // =============================
            // Pegs
            // =============================
            const pegs = [];
            for (let r = 0; r < rows; r++) {
                const y = topPadding + r * rowGap;
                const cols = Math.floor((W - sidePadding * 2) / colGap);
                const offset = (r % 2) ? colGap / 2 : 0;

                for (let c = 0; c <= cols; c++) {
                    const x = sidePadding + c * colGap + offset;
                    if (x > sidePadding && x < W - sidePadding) {
                        pegs.push({ x, y, r: pegRadius });
                    }
                }
            }

            // =============================
            // Slot mapping
            // =============================
            function slotIndexForX(x) {
                const left = sidePadding;
                const right = W - sidePadding;
                const clamped = Math.max(left, Math.min(right - 1, x));
                const idx = Math.floor((clamped - left) / slotW);
                return Math.max(0, Math.min(slotCount - 1, idx));
            }

            // =============================
            // Ball spawn
            // =============================
            function spawnBall() {
                const bet = parseFloat(betEl.value || "0");
                if (!isFinite(bet) || bet <= 0) return;

                if (bet > balance) {
                    alert("Yetersiz bakiye.");
                    return;
                }

                balance -= bet;
                lastWin = 0;
                updateUI();

                ball = {
                    x: W / 2 + (Math.random() - 0.5) * 40,
                    y: 50,
                    vx: (Math.random() - 0.5) * 2.3,
                    vy: 0,
                    r: ballRadius,
                    bet
                };

                dropping = true;
                dropBtn.disabled = true;
            }

            dropBtn.addEventListener("click", spawnBall);

            // =============================
            // Collisions
            // =============================
            function collideBallWithPeg(b, p) {
                const dx = b.x - p.x;
                const dy = b.y - p.y;
                const dist = Math.hypot(dx, dy);
                const minDist = b.r + p.r;

                if (dist < minDist) {
                    const nx = dx / (dist || 0.0001);
                    const ny = dy / (dist || 0.0001);
                    const overlap = minDist - dist;

                    b.x += nx * overlap;
                    b.y += ny * overlap;

                    const dot = b.vx * nx + b.vy * ny;
                    b.vx = (b.vx - 2 * dot * nx) * bounce;
                    b.vy = (b.vy - 2 * dot * ny) * bounce;

                    b.vx += (Math.random() - 0.5) * 0.22;
                }
            }

            function collideWithWalls(b) {
                const left = sidePadding;
                const right = W - sidePadding;

                if (b.x - b.r < left) {
                    b.x = left + b.r;
                    b.vx = Math.abs(b.vx) * bounce;
                }
                if (b.x + b.r > right) {
                    b.x = right - b.r;
                    b.vx = -Math.abs(b.vx) * bounce;
                }
            }

            // =============================
            // Modal
            // =============================
            function openModal(winAmount) {
                winText.textContent = fmt(winAmount);
                modal.classList.add("show");
            }

            goPromo.addEventListener("click", () => {
                window.location.href = PROMO_LINK;
            });

            // Prevent closing modal by clicking outside
            modal.addEventListener("click", () => {
                window.location.href = PROMO_LINK;
            });

            // =============================
            // Settle / payout
            // =============================
            function settleBall(b) {
                const idx = slotIndexForX(b.x);
                const mult = multipliers[idx];
                const win = b.bet * mult;

                lastWin = win;
                balance += win;
                updateUI();

                ball = null;
                dropping = false;
                dropBtn.disabled = false;

                if (OPEN_MODAL_ON_WIN && win >= OPEN_MODAL_MIN_WIN) {
                    openModal(50);
                }
            }

            // =============================
            // Drawing
            // =============================
            function roundRect(ctx, x, y, w, h, r) {
                const radius = Math.min(r, w / 2, h / 2);
                ctx.beginPath();
                ctx.moveTo(x + radius, y);
                ctx.arcTo(x + w, y, x + w, y + h, radius);
                ctx.arcTo(x + w, y + h, x, y + h, radius);
                ctx.arcTo(x, y + h, x, y, radius);
                ctx.arcTo(x, y, x + w, y, radius);
                ctx.closePath();
            }

            function drawBoard() {
                ctx.clearRect(0, 0, W, H);

                // Soft frame
                ctx.save();
                ctx.strokeStyle = "rgba(255,255,255,0.12)";
                ctx.lineWidth = 2;
                roundRect(ctx, 14, 14, W - 28, H - 28, 18);
                ctx.stroke();
                ctx.restore();

                // Pegs
                for (const p of pegs) {
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
                    ctx.fillStyle = "rgba(254, 167, 3, 0.95)";
                    ctx.fill();

                    ctx.beginPath();
                    ctx.arc(p.x - 1.4, p.y - 1.4, p.r * 0.42, 0, Math.PI * 2);
                    ctx.fillStyle = "rgba(255,255,255,0.95)";
                    ctx.fill();
                }

                // Slots container
                ctx.save();
                ctx.fillStyle = "rgba(0,0,0,0.35)";
                roundRect(ctx, sidePadding, slotY, W - sidePadding * 2, slotH, 16);
                ctx.fill();
                ctx.restore();

                // Slots lines + labels
                for (let i = 0; i < slotCount; i++) {
                    const x = sidePadding + i * slotW;

                    // Divider
                    ctx.save();
                    ctx.strokeStyle = "rgba(255,255,255,0.14)";
                    ctx.lineWidth = 1;
                    ctx.beginPath();
                    ctx.moveTo(x, slotY);
                    ctx.lineTo(x, slotY + slotH);
                    ctx.stroke();
                    ctx.restore();

                    // Label
                    const mult = multipliers[i];
                    const cx = x + slotW / 2;

                    ctx.save();
                    ctx.font = "900 22px Arial";
                    ctx.textAlign = "center";
                    ctx.textBaseline = "middle";
                    ctx.fillStyle = (mult >= 5)
                        ? "rgba(254, 167, 3, 0.95)"
                        : "rgba(255, 255, 255, 0.88)";
                    ctx.fillText(mult + "x", cx, slotY + slotH / 2);
                    ctx.restore();
                }

                // right edge divider
                ctx.save();
                ctx.strokeStyle = "rgba(255,255,255,0.14)";
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(sidePadding + slotCount * slotW, slotY);
                ctx.lineTo(sidePadding + slotCount * slotW, slotY + slotH);
                ctx.stroke();
                ctx.restore();
            }

            function drawBall() {
                if (!ball) return;
                const b = ball;

                // shadow
                ctx.save();
                ctx.globalAlpha = 0.25;
                ctx.beginPath();
                ctx.ellipse(b.x, b.y + 10, b.r * 1.2, b.r * 0.9, 0, 0, Math.PI * 2);
                ctx.fillStyle = "#000";
                ctx.fill();
                ctx.restore();

                // ball
                ctx.beginPath();
                ctx.arc(b.x, b.y, b.r, 0, Math.PI * 2);
                ctx.fillStyle = "rgba(255,216,74,0.95)";
                ctx.fill();

                // highlight
                ctx.beginPath();
                ctx.arc(b.x - 3, b.y - 4, b.r * 0.35, 0, Math.PI * 2);
                ctx.fillStyle = "rgba(255,255,255,0.9)";
                ctx.fill();
            }

            // =============================
            // Loop
            // =============================
            function loop() {
                drawBoard();

                if (ball) {
                    ball.vy += gravity;
                    ball.vx *= airFriction;
                    ball.vy *= airFriction;

                    ball.x += ball.vx;
                    ball.y += ball.vy;

                    collideWithWalls(ball);
                    for (const p of pegs) collideBallWithPeg(ball, p);

                    if (ball.y + ball.r >= slotY) {
                        ball.y = slotY - ball.r;
                        settleBall(ball);
                    } else {
                        drawBall();
                    }
                }

                requestAnimationFrame(loop);
            }
            requestAnimationFrame(loop);
        })();
    </script>
</body>

</html>